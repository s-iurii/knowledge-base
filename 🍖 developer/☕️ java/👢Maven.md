[[Apache Maven]]

При подключении библиотеки в Maven необходимо указать несколько основных параметров:

1. **`groupId`** — идентификатор группы, которой принадлежит библиотека.
2. **`artifactId`** — уникальный идентификатор библиотеки.
3. **`version`** — версия библиотеки.
4. **`scope`** — область видимости, которая указывает, на каком этапе сборки будет использоваться библиотека.
# **profiles**

В **Maven** профили (**profiles**) — это механизм, который позволяет изменять поведение сборки проекта в зависимости от среды или конфигурации. Это может быть полезно, например, для настройки проекта в разных окружениях (локальная разработка, тестирование, продакшн) или для сборки с разными параметрами (например, включение/выключение определённых модулей или плагинов).

### Основные моменты о профилях в Maven:

- **Профили** позволяют изменять конфигурацию проекта (например, зависимости, плагины, свойства и т.д.) в зависимости от условий выполнения сборки.
- Профили могут быть активированы по разным критериям, таким как значения системных переменных, свойства проекта, наличие файлов и т.д.
- Профили определяются в файле `pom.xml` и могут быть как локальными (определёнными в проекте), так и глобальными (определёнными в конфигурации Maven).

### Зачем нужны профили?

Предположим, что твой проект должен собираться по-разному в зависимости от окружения:

- В **локальной среде** (разработка) — нужно включать отладочные зависимости и плагины.
- В **тестовой среде** — нужно подключить специфичные зависимости для тестов.
- В **продакшене** — необходимо исключить отладочные зависимости и использовать оптимизированные настройки.

В таких случаях профили позволяют легко переключаться между этими конфигурациями с минимальными изменениями в проекте.

### Как определить профили в `pom.xml`?

Профили в Maven могут быть определены внутри элемента `<profiles>` файла `pom.xml`.

#### Пример:

```XML
<project>     ...     <profiles>         
<!-- Профиль для локальной разработки -->         
<profile>             
	<id>dev</id> <!-- Уникальный идентификатор профиля -->             <properties>                 
	<env>development</env>             
</properties>             
<dependencies>                 
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<version>2.5.4</version>
			<scope>runtime</scope>                
		</dependency>
</dependencies>         
</profile>          
<!-- Профиль для продакшн-сборки -->         
<profile>             
	<id>prod</id>             
	<properties>                 
		<env>production</env>             
	</properties>             
	<build>                 
	<plugins>
			<plugin>                         <groupId>org.apache.maven.plugins</groupId>                         <artifactId>maven-compiler-plugin</artifactId>                         <version>3.8.1</version>                         
<configuration>                             
<source>11</source>                             
<target>11</target>                             <optimize>true</optimize>                         
</configuration>                     
</plugin>                 
</plugins>             
</build>         
</profile>    
</<profiles> 
</project>
```


### Как активировать профили?

Maven позволяет активировать профили несколькими способами:

1. **Явное указание через командную строку**:
    
    Ты можешь явно указать, какой профиль активировать при сборке проекта, используя флаг `-P`:
    
    `mvn clean install -Pdev`
    
    Это активирует профиль с `id="dev"`, который описан в `pom.xml`.
    
2. **Автоматическая активация через условия**:
    
    Профили могут автоматически активироваться в зависимости от определённых условий, например:
    
    - Наличие системной переменной.
    - Версия JDK.
    - Наличие определённого файла.
    - По умолчанию.

#### Пример активации профиля по системной переменной:

xml

Копировать код

`<profiles>     <profile>         <id>test-profile</id>         <activation>             <property>                 <name>env</name>                 <value>test</value> <!-- Активируется, если установлена системная переменная env=test -->             </property>         </activation>         <properties>             <env>test</env>         </properties>     </profile> </profiles>`

Чтобы активировать этот профиль, нужно передать системную переменную через командную строку:

`mvn clean install -Denv=test`

#### Пример активации профиля по версии JDK:

`<profile>     <id>jdk-11</id>     <activation>         <jdk>11</jdk> <!-- Профиль активируется, если используется JDK 11 -->     </activation>     <build>         <plugins>             <plugin>                 <groupId>org.apache.maven.plugins</groupId>                 <artifactId>maven-compiler-plugin</artifactId>                 <version>3.8.1</version>                 <configuration>                     <source>11</source>                     <target>11</target>                 </configuration>             </plugin>         </plugins>     </build> </profile>`

### Автоматическая активация профилей:

1. **По наличию файла**: Профиль можно активировать, если существует или отсутствует определённый файл.
    
    `<profile>     <id>config-profile</id>     <activation>         <file>             <exists>config.properties</exists> <!-- Профиль активируется, если файл существует -->         </file>     </activation> </profile>`
    
2. **Профиль по умолчанию**: Ты можешь указать профиль, который будет активирован, если никакой другой профиль явно не указан.

    
    `<profile>     <id>default</id>     <activation>         <activeByDefault>true</activeByDefault> <!-- Этот профиль активируется по умолчанию -->     </activation> </profile>`
    

### Когда использовать профили?

Профили полезны, когда тебе нужно собирать проект с различными настройками для разных сред или задач. Вот несколько примеров использования профилей:

1. **Разные среды (development, testing, production)**:
    
    - Для каждой среды можно определить свои зависимости, плагины и конфигурации.
2. **Разные версии Java**:
    
    - Если нужно собрать проект под разные версии Java, можно использовать профили для разных конфигураций компилятора.
3. **Отладка**:
    
    - Можно включить отладочные зависимости или плагины только для локальной разработки, а для продакшн-сборки отключить их.
4. **Сборка с различными параметрами**:
    
    - Можно собирать проект с различными модулями или функциональностью, в зависимости от того, какой профиль активирован.

### Пример сложной конфигурации с профилями:

Представь, что у тебя есть проект, который должен собираться по-разному для разработки и для продакшн-среды:

xml

Копировать код

`<profiles>     <!-- Профиль для разработки -->     <profile>         <id>dev</id>         <properties>             <database.url>jdbc:h2:mem:devdb</database.url>         </properties>         <dependencies>             <dependency>                 <groupId>org.h2</groupId>                 <artifactId>h2</artifactId>                 <scope>runtime</scope>             </dependency>         </dependencies>     </profile>      <!-- Профиль для продакшн -->     <profile>         <id>prod</id>         <properties>             <database.url>jdbc:postgresql://prod-db:5432/proddb</database.url>         </properties>         <dependencies>             <dependency>                 <groupId>org.postgresql</groupId>                 <artifactId>postgresql</artifactId>                 <scope>runtime</scope>             </dependency>         </dependencies>     </profile> </profiles>`

- В **профиле разработки** используется база данных `H2`, и на этапе выполнения добавляется зависимость на `H2`.
- В **профиле продакшн** используется база данных `PostgreSQL`, и зависимости на неё подключаются только в этом профиле.


# **Типы артефактов (packaging)**

1. **JAR (Java ARchive)**:
    
    - Это наиболее распространённый тип артефакта. Обычно это библиотеки, которые используются в других проектах.
    - Пример: `spring-core.jar`.
2. **WAR (Web Application Archive)**:
    
    - Используется для упаковки веб-приложений. Включает в себя файлы JSP, HTML, сервлеты и т.д.
    - Пример: `my-web-app.war`.
3. **POM (Project Object Model)**:
    
    - Используется для модульных проектов или управления зависимостями. Это специальный тип, который не содержит исходного кода, а только конфигурацию проекта.
    - Пример: `spring-boot-dependencies.pom`.
4. **EAR (Enterprise Archive)**:
    
    - Используется для упаковки корпоративных приложений (обычно в J2EE). Включает в себя файлы JAR и WAR.
    - Пример: `my-enterprise-app.ear`.
5. **ZIP и другие форматы**:
    
    - Иногда артефакты могут быть упакованы в другие форматы, такие как `zip`, `tar`, и т.д.

# **Артефакты и области видимости зависимостей (scope)**

Когда ты подключаешь артефакт в проект через зависимость, ты можешь указать его область видимости (scope). Это определяет, как и когда артефакт будет доступен в твоём проекте.

1. **`compile` (по умолчанию)**:
    
    - Зависимость доступна на всех этапах сборки и выполнения.
    - Пример: библиотеки, необходимые для компиляции и выполнения программы.
2. **`provided`**:
    
    - Зависимость необходима для компиляции, но она не включается в окончательный пакет, так как ожидается, что она будет предоставлена средой выполнения (например, контейнером сервлетов).
    - Пример: `javax.servlet:servlet-api`.
3. **`runtime`**:
    
    - Зависимость не нужна для компиляции, но требуется для выполнения программы.
    - Пример: драйвер базы данных.
4. **`test`**:
    
    - Зависимость используется только во время тестирования. Она не включается в основной пакет.
    - Пример: `junit:junit`.
5. **`system`**:
    
    - Зависимость указывается с абсолютным путем на файловой системе,
